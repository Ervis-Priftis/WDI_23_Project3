"use strict";function Router(e,l){e.state("challengesIndex",{url:"/challenges",templateUrl:"/templates/challengesIndex.html",controller:"ChallengesIndexController as challengesIndex"}).state("challengesNew",{url:"/challenges/new",templateUrl:"/templates/challengesNew.html",controller:"ChallengesNewController as challengesNew"}).state("challengesShow",{url:"/challenges/:id",templateUrl:"/templates/challengesShow.html",controller:"ChallengesShowController as challengesShow"}).state("challengesEdit",{url:"/challenges/:id/edit",templateUrl:"/templates/challengesEdit.html",controller:"ChallengesEditController as challengesEdit"}).state("register",{url:"/register",templateUrl:"/templates/register.html",controller:"RegisterController as register"}).state("login",{url:"/login",templateUrl:"/templates/login.html",controller:"LoginController as login"}).state("home",{url:"/",templateUrl:"/templates/home.html"}).state("usersIndex",{url:"/challengers",templateUrl:"/templates/usersIndex.html",controller:"UsersIndexController as usersIndex"}).state("usersEdit",{url:"/challengers/:id/edit",templateUrl:"/templates/usersEdit.html",controller:"UsersEditController as usersEdit"}).state("usersShow",{url:"/challengers/:id",templateUrl:"/templates/usersShow.html",controller:"UsersShowController as usersShow"}),l.otherwise("/challenges")}function Auth(e){e.loginUrl="/login",e.signupUrl="/register",e.tokenPrefix=""}function RegisterController(e,l){function t(){e.signup(r.user).then(function(){l.go("home")})}var r=this;r.user={},r.submit=t}function LoginController(e,l,t,r){function n(){o.isLoggedIn=!0,console.log(o.isLoggedIn),e.login(o.credentials).then(function(){o.currentUser=e.getPayload(),o.currentUser&&t.get({id:o.currentUser._id},function(e){r.account=e,console.log(r.currentUser)}),l.go("home")})}var o=this;o.credentials={},o.submit=n}function Challenge(e){return new e("/challenges/:id",{id:"@_id"},{update:{method:"PUT"}})}function ChallengesIndexController(e){var l=this;l.all=e.query()}function ChallengesNewController(e,l){function t(){e.save(r.challenge,function(){l.go("challengesIndex")})}var r=this;r.challenge={},r.create=t}function ChallengesShowController(e,l,t,r){function n(){i.challenge.$remove(function(){t.go("challengesIndex")})}function o(){var e=i.challenge.like.indexOf(i.authUser);!i.challenge.like.includes(i.authUser)&&i.authUser?(i.challenge.like.push(i.authUser),i.challenge.$update()):i.challenge.like.includes(i.authUser)&&i.authUser&&(i.challenge.like.splice(e,1),i.challenge.$update())}function s(){i.challenge.participants.data.push(i.authUser),i.challenge.participants.userId.push(i.authUser),i.challenge.$update(function(e){console.log(e),console.log(i.challenge.participants.userId)}),i.userProfile.activeChallenges.push(i.challenge._id),i.challenge.$update(),i.userProfile.$update()}function a(){var e=i.challenge.participants.userId.indexOf(i.authUser);i.challenge.participants.userId.splice(e,1),console.log(i.challenge.participants.userId)}var i=this;i.authUser=r.getPayload(),i.authUser&&(i.authUser=i.authUser._id,l.get({id:i.authUser},function(e){i.userProfile=e})),i.challenge=e.get(t.params),i.Unparticipate=a,i.participate=s,i.incrementLikes=o,i.isLoggedIn=r.isAuthenticated,i.delete=n}function ChallengesEditController(e,l){function t(){r.challenge.$update(function(){l.go("challengesShow",l.params)})}var r=this;r.challenge=e.get(l.params),this.update=t}function currentUser(e,l){var t=this,r=l.getPayload();r&&e.get({id:r._id},function(e){t.account=e})}function dragDrop(){return{restrict:"E",place:!0,templateUrl:"templates/dragDrop.html",link:function(e,l){console.log(l)}}}function MainController(e){function l(){console.log("in toggle menu"),t.menuActive=!t.menuActive,console.log(t.menuActive)}var t=this;t.isLoggedIn=e.isAuthenticated,t.currentUser=e.getPayload(),t.toggleMenu=l,t.togglePopUp=!t.togglePopUp}function ProfileController(e,l,t,r){function n(){e.logout().then(function(){o.account=null,l.go("home")})}var o=this;o.isLoggedIn=e.isAuthenticated,e.getPayload()&&(o.currentUserId=e.getPayload()._id),o.currentUser=r,o.isLoggedIn()&&t.get({id:o.currentUserId},function(e){r.account=e}),o.logout=n,o.message=null}function User(e){return new e("/users/:id",{id:"@_id"},{update:{method:"PUT"}})}function user(){var e=this;e.account={}}function UsersIndexController(e){var l=this;l.all=e.query()}function UsersNewController(e,l){function t(){e.save(r.user,function(){l.go("userIndex")})}var r=this;r.user={},r.create=t}function UsersShowController(e,l,t){function r(){var e=o.user.likes.indexOf(o.authUser);!o.user.likes.includes(o.authUser)&&o.authUser?(o.user.likes.push(o.authUser),o.user.$update()):o.user.likes.includes(o.authUser)&&o.authUser&&(o.user.likes.splice(e,1),o.user.$update())}function n(){o.user.$remove(function(){l.go("usersIndex")})}var o=this;e.get(l.params,function(e){o.user=e,o.authUser=t.getPayload(),o.authUser&&(o.authUser=o.authUser._id),o.incrementLikes=r,o.isLoggedIn=t.isAuthenticated,o.delete=n})}function UsersEditController(e,l,t){function r(){n.user.$update(function(e){console.log(e.bio),l.go("usersShow",{id:n.authUser})})}var n=this;n.authUser=t.getPayload(),n.authUser&&(n.authUser=n.authUser._id),e.get({id:n.authUser},function(e){n.user=e,console.log(n.user)}),n.update=r}angular.module("goApp",["ngResource","ui.router","satellizer"]).config(Router).config(Auth),Router.$inject=["$stateProvider","$urlRouterProvider"],Auth.$inject=["$authProvider"],angular.module("goApp").controller("RegisterController",RegisterController).controller("LoginController",LoginController),RegisterController.$inject=["$auth","$state"],LoginController.$inject=["$auth","$state","User","user"],angular.module("goApp").factory("Challenge",Challenge),Challenge.$inject=["$resource"],angular.module("goApp").controller("ChallengesIndexController",ChallengesIndexController).controller("ChallengesNewController",ChallengesNewController).controller("ChallengesShowController",ChallengesShowController).controller("ChallengesEditController",ChallengesEditController),ChallengesIndexController.$inject=["Challenge"],ChallengesNewController.$inject=["Challenge","$state"],ChallengesShowController.$inject=["Challenge","User","$state","$auth"],ChallengesEditController.$inject=["Challenge","$state"],angular.module("goApp").service("currentUser",currentUser),currentUser.$inject=["User","$auth"],angular.module("imageUploader").directive("dragDrop",dragDrop),angular.module("goApp").controller("MainController",MainController),MainController.$inject=["$auth"],angular.module("goApp").controller("ProfileController",ProfileController),ProfileController.$inject=["$auth","$state","User","user"],angular.module("goApp").factory("User",User),User.$inject=["$resource"],angular.module("goApp").service("user",user),angular.module("goApp").controller("UsersIndexController",UsersIndexController).controller("UsersNewController",UsersNewController).controller("UsersShowController",UsersShowController).controller("UsersEditController",UsersEditController),UsersIndexController.$inject=["User"],UsersNewController.$inject=["User","$state"],UsersShowController.$inject=["User","$state","$auth"],UsersEditController.$inject=["User","$state","$auth"];
//# sourceMappingURL=app.js.map
